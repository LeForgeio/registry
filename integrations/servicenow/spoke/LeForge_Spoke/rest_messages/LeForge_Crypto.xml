<?xml version="1.0" encoding="UTF-8"?>
<!--
    LeForge Crypto REST Message
    REST API configuration for Crypto Service endpoints
-->
<unload>
    <sys_rest_message action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <description>LeForge Crypto Service REST API - Hash, Encrypt, Decrypt, Generate Keys</description>
        <name>LeForge_Crypto</name>
        <rest_endpoint>${endpoint}/crypto</rest_endpoint>
        <sys_id>LeForge_rest_message_crypto</sys_id>
        
        <http_methods>
            <!-- Hash Method -->
            <sys_rest_message_fn>
                <function_name>hash</function_name>
                <http_method>POST</http_method>
                <rest_endpoint>${endpoint}/crypto/hash</rest_endpoint>
                <content_type>application/json</content_type>
                <request_headers>
                    <header name="X-API-Key">${api_key}</header>
                </request_headers>
                <http_request_body>{
    "data": "${data}",
    "algorithm": "${algorithm}",
    "encoding": "${encoding}"
}</http_request_body>
            </sys_rest_message_fn>
            
            <!-- Encrypt Method -->
            <sys_rest_message_fn>
                <function_name>encrypt</function_name>
                <http_method>POST</http_method>
                <rest_endpoint>${endpoint}/crypto/encrypt</rest_endpoint>
                <content_type>application/json</content_type>
                <request_headers>
                    <header name="X-API-Key">${api_key}</header>
                </request_headers>
                <http_request_body>{
    "data": "${data}",
    "key": "${key}",
    "algorithm": "${algorithm}"
}</http_request_body>
            </sys_rest_message_fn>
            
            <!-- Decrypt Method -->
            <sys_rest_message_fn>
                <function_name>decrypt</function_name>
                <http_method>POST</http_method>
                <rest_endpoint>${endpoint}/crypto/decrypt</rest_endpoint>
                <content_type>application/json</content_type>
                <request_headers>
                    <header name="X-API-Key">${api_key}</header>
                </request_headers>
                <http_request_body>{
    "encrypted": "${encrypted}",
    "key": "${key}",
    "iv": "${iv}",
    "tag": "${tag}",
    "algorithm": "${algorithm}"
}</http_request_body>
            </sys_rest_message_fn>
            
            <!-- Generate Key Method -->
            <sys_rest_message_fn>
                <function_name>generate_key</function_name>
                <http_method>POST</http_method>
                <rest_endpoint>${endpoint}/crypto/generate-key</rest_endpoint>
                <content_type>application/json</content_type>
                <request_headers>
                    <header name="X-API-Key">${api_key}</header>
                </request_headers>
                <http_request_body>{
    "length": ${length},
    "encoding": "${encoding}"
}</http_request_body>
            </sys_rest_message_fn>
        </http_methods>
    </sys_rest_message>
</unload>
